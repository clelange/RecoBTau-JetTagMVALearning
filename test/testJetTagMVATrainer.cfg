#!/usr/bin/env cmsRun

process IPTrainer = {
	source = PoolSource {
		untracked vstring fileNames = { 
			"file:testTagInfos.root",
		}
	}

	include "FWCore/MessageLogger/data/MessageLogger.cfi"
	replace MessageLogger.cout.threshold = "INFO"

	service = PoolDBOutputService {
		string connect = "sqlite_file:MVAImpactParameterJetTags.db"
		string timetype = "runnumber"
		untracked uint32 authenticationMethod = 1
		untracked string catalog = "file:mycatalog.xml"

		VPSet toPut = {
			{
				string record = "BTauGenericMVAJetTagComputerRcd"
				string tag = "test_tag"
			}
		}

		PSet DBParameters = {
			untracked string authenticationPath = "."
			untracked int32 messageLevel = 0
			untracked bool loadBlobStreamer = true
		}
	}

	module jetTagMVATrainerSave = JetTagMVATrainerSave {
		vstring toCopy = { }
		vstring toPut = { "ImpactParameter" }
	}

	module impactParameterMVATrainer = JetTagMVATrainer { 
		InputTag tagInfo		= impactParameterTagInfos
		string calibrationRecord	= "ImpactParameter"
		vint32 ignoreFlavours		= { 0 }
		vint32 signalFlavours		= { 5, 7 }
		double minimumTransverseMomentum = 10.0
		double minimumPseudoRapidity	= 0
		double maximumPseudoRapidity	= 2.5

		PSet jetIdParameters = {
			string mcSource			= "source"
			bool fillPartons		= true
			bool fillHeavyHadrons		= false
			bool fillLeptons		= false
			double coneSizeToAssociate	= 0.3
			bool physicsDefinition		= false
			bool rejectBCSplitting		= false
			vstring vetoFlavour		= { }
		}
	}

	looper = JetTagMVATrainerLooper {
		VPSet trainers = {
			{
				string calibrationRecord = "ImpactParameter"
				untracked string trainDescription =
						"ImpactParameterMVATrainer.xml"
				untracked bool loadState = false
				untracked bool saveState = false
			}
		}
	}


	path p = {
		impactParameterMVATrainer
	}

	endpath outpath = { jetTagMVATrainerSave }
}
